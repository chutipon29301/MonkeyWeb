let listAllTest=(()=>{var a=_asyncToGenerator(function*(){$("#testList").empty();let b=yield $.get("/courseTestList");$("#testList").append(b)});return function(){return a.apply(this,arguments)}})(),getTestDetail=(()=>{var a=_asyncToGenerator(function*(b){let c=yield $.get("/courseTestDetail",{testID:b});$("#testDetail").empty(),$("#testDetail").append(c)});return function(){return a.apply(this,arguments)}})(),addStudentScore=(()=>{var a=_asyncToGenerator(function*(){let c=yield $.get("/courseTestOption");$("#courseSelect").empty(),$("#courseSelect").append(c),$("#addStudentModal").modal("show")});return function(){return a.apply(this,arguments)}})();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),j=h.value}catch(k){return void d(k)}return h.done?void c(j):Promise.resolve(j).then(function(k){e("next",k)},function(k){e("throw",k)})}return e("next")})}}listAllTest(),$("#addNewTestBtn").click(function(){$("#addTestModal").modal("show")}),$("#addTestSubmitBtn").click(function(){0>=$("#addTestName").val().length?alert("Please input test name."):0>=$("#addTestScore").val().length?alert("Please input test max score."):0>=$("#addTestDate").val().length?alert("Please select test date."):confirm("Add new test?")&&$.post("v2/testScore/addTest",{testName:$("#addTestName").val(),maxScore:$("#addTestScore").val(),testDate:$("#addTestDate").val()}).then(a=>{console.log(a),listAllTest(),$("#addTestModal").modal("hide")})}),$("#testList").on("click","button",function(){sessionStorage.setItem("testScoreTestID",this.name.slice(5)),getTestDetail(this.name.slice(5)),$(this).hasClass("btn-outline-secondary")?($(".test-list-btn").removeClass("btn-secondary").addClass("btn-outline-secondary"),$(this).toggleClass("btn-secondary btn-outline-secondary")):$(this).toggleClass("btn-secondary btn-outline-secondary")});function getBlank(){$("#testDetail").empty(),$("#testDetail").append("<div class='col-12 text-center'><h1>Please select a test.</h1></div>")}function deleteTest(a){confirm("Are you sure to delete this test?")&&$.post("v2/testScore/deleteTest",{testID:a}).then(b=>{console.log(b),getBlank(),listAllTest()})}function removeStudent(a,b){confirm("Remove student from this test?")&&$.post("v2/testScore/removeStudent",{testID:a,students:[b]}).then(c=>{console.log(c),getTestDetail(a)})}$("#courseSelect").change(_asyncToGenerator(function*(){if("0"!=this.value){let a=yield $.post("post/courseInfo",{courseID:this.value}),b=[];for(let d of a.student)b.push(name(d));let c=yield Promise.all(b);for(let d=0;d<a.student.length;d++)a.student[d]={id:a.student[d],name:c[d].nickname+" "+c[d].firstname};a.student=_.orderBy(a.student,["name"],["asc"]),$("#studentList").empty();for(let d of a.student)$("#studentList").append("<button class=\"student-btn col-12 btn btn-warning my-1\" name=\""+d.id+"\">"+d.name+"</button>")}})),$("#studentList").on("click",".student-btn",function(){sessionStorage.setItem("testScoreStudentID",this.name),$("#addStudentScoreModal").modal("show")}),$("#addStudentScoreSubmitBtn").click(function(){let a=sessionStorage.getItem("testScoreTestID"),b=sessionStorage.getItem("testScoreStudentID"),c=$("#studentScore").val();""!=c&&$.post("v2/testScore/addStudent",{testID:a,students:{_id:b,score:c}}).then(()=>{getTestDetail(a),$("#addStudentScoreModal").modal("hide"),$("#studentScore").val("")})});