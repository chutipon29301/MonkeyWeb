let initGlobalData=(()=>{var a=_asyncToGenerator(function*(){for(let f,e=1;13>e;e++)f=7>e?"P"+e:"S"+(e-6),$(".gradeSelect").append("<option value="+e+">"+f+"</option>");$(".subjectSelect").append("<option value='M'>Math</option><option value='P'>Physic</option><option value='C'>Chemistry</option><option value='E'>English</option><option value='Sci'>Science</option>");let[b,c,d]=yield Promise.all([getConfig(),listQuarter("private"),$.post("post/v1/listTutorJson")]);for(let e in $("#setDefaultQYearInput").attr("placeholder",b.defaultQuarter.quarter.year),$("#setDefaultQQuarterInput").attr("placeholder",b.defaultQuarter.quarter.quarter),$("#setSummerQYearInput").attr("placeholder",b.defaultQuarter.summer.year),$("#setSummerQQuarterInput").attr("placeholder",b.defaultQuarter.summer.quarter),$("#setRegisQYearInput").attr("placeholder",b.defaultQuarter.registration.year),$("#setRegisQQuarterInput").attr("placeholder",b.defaultQuarter.registration.quarter),$("#allowRegisConfigOption").val(b.allowRegistration?"1":"0"),$("#configProfilePicPathInput").val(b.profilePicturePath),$("#configReceiptPathInput").val(b.receiptPath),$("#configSlideShowPathInput").val(b.studentSlideshowPath),$("#configStdCommentPathInput").val(b.studentCommentPicturePath),$("#configCrMaterialPathInput").val(b.courseMaterialPath),$("#configDocPathInput").val(b.documentPath),$("#configAttendDocPathInput").val(b.attendanceDocumentPath),$("#configCrPrice").val(b.coursePrice),$("#configNxtStd").val(b.nextStudentID),$("#configNxtTutor").val(b.nextTutorID),c.quarter)$(".quarterSelect").prepend("<option value="+c.quarter[e].year+"-"+c.quarter[e].quarter+">"+c.quarter[e].name+"</option>");for(let e in d.tutors)$(".tutorSelect").append("<option value="+d.tutors[e].tutorID+">"+d.tutors[e].nicknameEn+"</option>")});return function(){return a.apply(this,arguments)}})();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),k=h.value}catch(l){return void d(l)}return h.done?void c(k):Promise.resolve(k).then(function(l){e("next",l)},function(l){e("throw",l)})}return e("next")})}}const containClass=a=>{if(-1<a.className.indexOf("userNav"))return"user";return-1<a.className.indexOf("stdNav")?"std":-1<a.className.indexOf("crNav")?"cr":-1<a.className.indexOf("configNav")?"config":-1<a.className.indexOf("etcNav")?"etc":void 0};$(".myContent").hide(),$(".navigationIcon").hide(),$(".myNav").click(function(){$("#navigation").slideUp(),$(".navigationIcon").slideDown(),$("."+containClass(this)+"Content").slideDown()}),$("#globalBack").click(function(){$("#navigation").slideDown(),$(".navigationIcon").slideUp(),$(".myContent").slideUp()}),initGlobalData();const addStudentGrade=()=>{$("#upgradeSizeInput").val()&&confirm("Are you sure to upgrade all student by "+$("#upgradeSizeInput").val())&&$.post("post/addStudentGrade",{toAdd:$("#upgradeSizeInput").val()}).then(a=>{log(a),alert("Complete to upgrade all student by "+$("#upgradeSizeInput").val())})},listAllCourse=()=>{let a=$("#allCourseQuarterSelect").val().slice(0,4),b=$("#allCourseQuarterSelect").val().slice(5);$.post("post/v1/allCourse",{year:a,quarter:b}).then(c=>{for(let d in $("#allCourseTableBody").empty(),c=_.sortBy(c,"courseName"),console.log(c),c)$("#allCourseTableBody").append("<tr><td class='text-center'>"+c[d].courseName+"</td><td class='text-center'>"+moment(c[d].day).format("ddd H")+"</td><td class='text-center'>"+c[d].grade+"</td><td class='text-center'>"+c[d].room+"</td><td class='text-center'>"+c[d].studentCount+"</td><td class='text-center'>"+c[d].tutorName+"</td><td>"+c[d].description+"</td></tr>")})},listGradeCourse=()=>{let a=$("#gradeCourseQuarterSelect").val().slice(0,4),b=$("#gradeCourseQuarterSelect").val().slice(5);$.post("post/gradeCourse",{year:a,quarter:b,grade:$("#gradeCourseGradeSelect").val()}).then(c=>{$("#gradeCourseTableBody").empty();let d=c.course;for(let e in d=_.sortBy(d,"courseName"),d)$("#gradeCourseTableBody").append("<tr><td class='text-center'>"+d[e].courseID+"</td><td class='text-center'>"+d[e].courseName+"</td><td class='text-center'>"+moment(d[e].day).format("ddd H")+"</td><td class='text-center'>"+d[e].description+"</td><td class='text-center'>"+d[e].tutor+"</td></tr>")})};$("#crInfoQuarterSelect").change(function(){"0"!==this.value&&$.post("post/v1/allCourse",{year:this.value.slice(0,4),quarter:this.value.slice(5)}).then(a=>{for(let b in $("#crInfoCourseSelect").empty(),a=_.sortBy(a,"courseName"),a)$("#crInfoCourseSelect").append("<option value="+a[b].courseID+">"+a[b].courseName+"-"+a[b].tutorName+"</option>")})}),$("#crInfoCourseSelect").change(function(){0!==this.value&&$.post("post/courseInfo",{courseID:this.value}).then(a=>{$("#crInfoOutput").empty(),$("#crInfoOutput").append("<p class='mb-1 mt-3'>Course name: "+a.courseName+"</p><p class='mb-1'>Day: "+moment(a.day).format("ddd H")+"</p><p class='mb-1'>Description: "+a.description+"</p><p class='mb-1'>Level: "+a.level+"</p><p class='mb-1'>Room: "+a.room+"</p><p class='mb-1'>Student: "+a.student+"</p><p class='mb-1'>Tutor: "+a.tutor+"</p>")})});const addNewCourse=()=>{if(0>=$(".addCourseCheck:checked").length)alert("Please select at least 1 grade!");else if(0>=$("#addCourseLevel").val().length)alert("Please input course level!");else{let a=$("#addCourseQuarterSelect").val().slice(0,4),b=$("#addCourseQuarterSelect").val().slice(5),c=$("#addCourseSubjectSelect").val(),d=$(".addCourseCheck:checked").map(function(){return this.value}).get(),e=$("#addCourseLevel").val(),f=$("#addCourseDaySelect").val(),g=$("#addCourseTutorSelect").val(),h=$("#addCourseRoomSelect").val(),k=$("#addCourseDescription").val();$.post("post/addCourse",{year:a,quarter:b,subject:c,grade:d,level:e,day:f,tutor:[g],description:k,room:h}).then(l=>{log("OK => "+l),alert("Complete to add course.")})}};var container=document.getElementById("container"),isTimerRunning=!1,i=0;container.onclick=()=>{i++,5==i&&(window.location="/dev"),isTimerRunning||setTimeout(()=>{i=0,isTimerRunning=!1},1e3)},$("#editCourseQuarterSelect").change(function(){if("0"!==this.value){let a=this.value.slice(0,4),b=this.value.slice(5);$.post("post/v1/allCourse",{year:a,quarter:b}).then(c=>{for(let d in $("#editCourseSelect").empty(),$("#editCourseSelect").append("<option value=0>Select Course</option>"),c=_.sortBy(c,"courseName"),c)$("#editCourseSelect").append("<option value="+c[d].courseID+">"+c[d].courseName+" - "+c[d].tutorName+" ("+moment(c[d].day).format("ddd H)")+"</option>")})}}),$("#editCourseSelect").change(function(){if("0"!==this.value){let a=$("#editCourseQuarterSelect").val().slice(0,4),b=$("#editCourseQuarterSelect").val().slice(5);$.post("post/courseInfo",{year:a,quarter:b,courseID:this.value}).then(c=>{for(let d in"S"===c.courseName.slice(0,1)?$("#editCourseSubjectSelect").val(c.courseName.slice(0,3)):$("#editCourseSubjectSelect").val(c.courseName.slice(0,1)),$(".editCourseCheck").prop("checked",!1),c.grade)$(".editCourseCheck:eq("+(c.grade[d]-1)+")").prop("checked",!0);$("#editCourseLevel").val(c.courseName.slice(-1)),$("#editCourseDaySelect").val(c.day),$("#editCourseTutorSelect").val(c.tutor[0]),$("#editCourseRoomSelect").val(c.room),$("#editCourseDescription").val(c.description)})}});const editCourse=()=>{if(0>=$(".editCourseCheck:checked").length)alert("Please select at least 1 grade!");else if(confirm("Are you sure to edit this course?")){let a=$("#editCourseSelect").val(),b=$("#editCourseSubjectSelect").val(),c=$(".editCourseCheck:checked").map(function(){return this.value}).get(),d=$("#editCourseLevel").val(),e=$("#editCourseDaySelect").val(),f=$("#editCourseTutorSelect").val(),g=$("#editCourseRoomSelect").val(),h=$("#editCourseDescription").val();$.post("post/editCourse",{courseID:a,subject:b,grade:c,level:d,day:e,tutor:[f],description:h,room:g}).then(k=>{log("OK => "+k),alert("Complete to edit course.")})}};$("#removeCourseQuarterSelect").change(function(){if("0"!==this.value){let a=this.value.slice(0,4),b=this.value.slice(5);$.post("post/v1/allCourse",{year:a,quarter:b}).then(c=>{for(let d in $("#removeCourseSelect").empty(),c=_.sortBy(c,"courseName"),c)$("#removeCourseSelect").append("<option value="+c[d].courseID+">"+c[d].courseName+" - "+c[d].tutorName+" ("+moment(c[d].day).format("ddd H)")+"</option>")})}});const removeCourse=()=>{"0"!==$("#removeCourseSelect").val()&&confirm("Are you sure to delete "+$("#removeCourseSelect").val())&&$.post("post/removeCourse",{courseID:$("#removeCourseSelect").val()}).then(a=>{log("OK => "+a),alert("Complete to remove course.")})};$("#addCourseSuggestQuarterSelect").change(function(){if("0"!==this.value){let a=this.value.slice(0,4),b=this.value.slice(5);$.post("post/v1/allCourse",{year:a,quarter:b}).then(c=>{for(let d in $("#addCourseSuggestSelect").empty(),c=_.sortBy(c,"courseName"),c)$("#addCourseSuggestSelect").append("<option value="+c[d].courseID+">"+c[d].courseName+" - "+c[d].tutorName+" ("+moment(c[d].day).format("ddd H)")+"</option>")})}});const addCourseSuggest=()=>{if("0"===$("#addCourseSuggestQuarterSelect").val()||"0"===$("#addCourseSuggestSelect").val()||"0"===$("#addCourseSuggestGradeSelect").val()||0>=$("#addCourseSuggestLevelInput").val().length)alert("Incorrect input, please check again.");else{let a=$("#addCourseSuggestQuarterSelect").val().slice(0,4),b=$("#addCourseSuggestQuarterSelect").val().slice(5);$.post("post/addCourseSuggestion",{year:a,quarter:b,grade:$("#addCourseSuggestGradeSelect").val(),level:$("#addCourseSuggestLevelInput").val(),courseID:[$("#addCourseSuggestSelect").val()]}).then(c=>{log("OK "+c),alert("Cpmplete to add course suggestion.")})}};$("#removeCourseSuggestQuarterSelect").change(function(){if("0"!==this.value){let a=this.value.slice(0,4),b=this.value.slice(5);$.post("post/v1/allCourse",{year:a,quarter:b}).then(c=>{for(let d in $("#removeCourseSuggestSelect").empty(),c=_.sortBy(c,"courseName"),c)$("#removeCourseSuggestSelect").append("<option value="+c[d].courseID+">"+c[d].courseName+" - "+c[d].tutorName+" ("+moment(c[d].day).format("ddd H)")+"</option>")})}});const removeCourseSuggest=()=>{if("0"===$("#removeCourseSuggestQuarterSelect").val()||"0"===$("#removeCourseSuggestSelect").val()||"0"===$("#removeCourseSuggestGradeSelect").val()||0>=$("#removeCourseSuggestLevelInput").val().length)alert("Incorrect input, please check again.");else{let a=$("#removeCourseSuggestQuarterSelect").val().slice(0,4),b=$("#removeCourseSuggestQuarterSelect").val().slice(5);$.post("post/removeCourseSuggestion",{year:a,quarter:b,grade:$("#removeCourseSuggestGradeSelect").val(),level:$("#removeCourseSuggestLevelInput").val(),courseID:[$("#removeCourseSuggestSelect").val()]}).then(c=>{log("OK "+c),alert("Cpmplete to remove course suggestion.")})}},listCourseSuggest=()=>{if("0"===$("#listCourseSuggestQuarterSelect").val()||"0"===$("#listCourseSuggestGradeSelect").val())alert("Please select quarter & grade.");else{let a=$("#listCourseSuggestQuarterSelect").val().slice(0,4),b=$("#listCourseSuggestQuarterSelect").val().slice(5);$.post("post/listCourseSuggestion",{year:a,quarter:b,grade:$("#listCourseSuggestGradeSelect").val()}).then(c=>{let d=c.course;$("#listCourseSuggestTable").empty(),$("#listCourseSuggestTable").append("<thead><tr></tr></thead><tbody><tr></tr></tbody>");let e=[];for(let f in d)for(let g in d[f].courseID)e.push(courseInfo(d[f].courseID[g]));Promise.all(e).then(f=>{let g=0;for(let h in d){for(let k in d[h].courseInfo=[],d[h].courseID)d[h].courseInfo.push(f[g]),g++;d[h].courseInfo=_.sortBy(d[h].courseInfo,"day")}for(let h in d){$("#listCourseSuggestTable thead tr").append("<th class='text-center'>"+d[h].level+"</th>"),$("#listCourseSuggestTable tbody tr").append("<td class='text-center' id='listCourseSuggestTableBody"+h+"'></td>");let k=d[h].courseInfo;for(let l in k){let m=moment(k[l].day).format("ddd H");$("#listCourseSuggestTableBody"+h).html($("#listCourseSuggestTableBody"+h).html()+k[l].courseName+" ("+m+")<BR>"),g++}}})})}},listAllQuarter=()=>{listQuarter("private").then(a=>{let b=a.quarter;for(let c in $("#allQuarterTableBody").empty(),b)$("#allQuarterTableBody").append("<tr><td class='text-center'>"+b[c].quarterID+"</td><td class='text-center'>"+b[c].name+"</td><td class='text-center'>"+b[c].year+"</td><td class='text-center'>"+b[c].quarter+"</td><td class='text-center'>"+b[c].maxSeat+"</td><td class='text-center'>"+b[c].week+"</td><td class='text-center'>"+b[c].status+"</td></tr>")})},addNewQuarter=()=>{0>=$("#addQuarterYearInput").val().length?alert("Please input year."):0>=$("#addQuarterQuarterInput").val().length?alert("Please input quarter."):0>=$("#addQuarterNameInput").val().length?alert("Please input name."):$.post("post/addQuarter",{year:$("#addQuarterYearInput").val(),quarter:$("#addQuarterQuarterInput").val(),name:$("#addQuarterNameInput").val(),status:"public"}).then(a=>{log("OK "+a),alert("Complete to add quarter.")})},setDefaultQuarter=()=>{let a={};0<$("#setDefaultQYearInput").val().length&&0<$("#setDefaultQQuarterInput").val().length&&(a.quarter={year:$("#setDefaultQYearInput").val(),quarter:$("#setDefaultQQuarterInput").val()}),0<$("#setSummerQYearInput").val().length&&0<$("#setSummerQQuarterInput").val().length&&(a.summer={year:$("#setSummerQYearInput").val(),quarter:$("#setSummerQQuarterInput").val()}),0<$("#setRegisQYearInput").val().length&&0<$("#setRegisQQuarterInput").val().length&&(a.registration={year:$("#setRegisQYearInput").val(),quarter:$("#setRegisQQuarterInput").val()}),$.post("post/v1/editDefaultQuarter",a).then(b=>{log(b),alert("Complete to edit config.")})},editDBConfig=()=>{let a={};a.allowRegistration="0"!==$("#allowRegisConfigOption").val(),a.profilePicturePath=$("#configProfilePicPathInput").val(),a.receiptPath=$("#configReceiptPathInput").val(),a.studentSlideshowPath=$("#configSlideShowPathInput").val(),a.studentCommentPicturePath=$("#configStdCommentPathInput").val(),a.courseMaterialPath=$("#configCrMaterialPathInput").val(),a.documentPath=$("#configDocPathInput").val(),a.attendanceDocumentPath=$("#configAttendDocPathInput").val(),a.coursePrice=$("#configCrPrice").val(),a.nextStudentID=$("#configNxtStd").val(),a.nextTutorID=$("#configNxtTutor").val(),$.post("post/v1/editConfig",a).then(b=>{log(b),alert("Complete to edit config.")})};