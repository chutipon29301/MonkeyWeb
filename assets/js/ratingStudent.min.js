let generateStudent=(()=>{var a=_asyncToGenerator(function*(b){let c;try{c=yield $.post("post/courseInfo",{courseID:b})}catch(f){return void alert("Error to get course info, try again later.")}let d=[];for(let f in c.student)d.push($.post("post/name",{userID:c.student[f]}));let e;try{e=yield Promise.all(d)}catch(f){return void alert("Error to get user name, try again later.")}for(let f in c.student)c.student[f]={id:c.student[f],nickname:e[f].nickname,firstname:e[f].firstname,nicknameEn:e[f].nicknameEn,firstnameEn:e[f].firstnameEn};addRatingInput(c)});return function(){return a.apply(this,arguments)}})();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),j=h.value}catch(k){return void d(k)}return h.done?void c(j):Promise.resolve(j).then(function(k){e("next",k)},function(k){e("throw",k)})}return e("next")})}}$("#form-container").hide(),$("#button-container").hide(),$("#cr-select").change(function(){0==this.value?($("#form-container").hide(),$("#button-container").hide(),$("#fetch-container").show()):(generateStudent(this.value),$("#form-container").show(),$("#button-container").show(),$("#fetch-container").hide())}),addRatingInput=a=>{let b=$("#student-container");b.empty();let c=a.student,d="#E1F5FE";for(let e in c)b.append("<div class='card' style='margin-bottom:8px'><div class='card-body'><div class='row'><div class='col-12 col-md-2'>"+c[e].nickname+" "+c[e].firstname+"</div><div class='col-12 col-md-5' style=\"background-color:"+d+"\"><label style='margin-bottom:0'><span class='fas fa-book-open'></span> Study</label><label style='margin-bottom:0' class='float-right' id="+c[e].id+"-std-score>2.5</label><input type='range' class='custom-range' min='0' max='5' step='0.5' id="+c[e].id+"-std-range></div><div class='col-12 col-md-5' style=\"background-color:"+d+"\"><label style='margin-bottom:0'><span class='fas fa-crown'></span> Behavior</label><label style='margin-bottom:0' class='float-right' id="+c[e].id+"-bv-score>2.5</label><input type='range' class='custom-range' min='0' max='5' step='0.5' id="+c[e].id+"-bv-range></div></div></div></div>")},$(document).on("change",".custom-range",function(){let a=this.id.slice(0,this.id.lastIndexOf("-"));$("#"+a+"-score").html(this.value)}),$("#submit-btn").click(function(){let a=$(".custom-range"),b={type:"study",scores:[],courseID:$("#cr-select").val()},c={type:"behavior",scores:[],courseID:$("#cr-select").val()};for(let d=0;d<a.length;d++){let e=a[d].id,f=e.slice(e.indexOf("-")+1,e.lastIndexOf("-")),g=e.slice(0,e.indexOf("-"));switch(f){case"bv":c.scores.push({studentID:g,score:a[d].value});break;case"std":b.scores.push({studentID:g,score:a[d].value});break;default:}}try{Promise.all([$.post("v2/rating/addMany",b),$.post("v2/rating/addMany",c)]).then(()=>{alert("Rating successful."),location.reload()})}catch(d){alert("Rating error, try again later.")}});